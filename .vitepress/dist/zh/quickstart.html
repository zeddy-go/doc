<!DOCTYPE html>
<html lang="zh" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>快速开始 | zeddy</title>
    <meta name="description" content="A Convenient Framework">
    <meta name="generator" content="VitePress v1.1.3">
    <link rel="preload stylesheet" href="/doc/assets/style.DeIyO9fO.css" as="style">
    
    <script type="module" src="/doc/assets/app.C2yS8iqI.js"></script>
    <link rel="preload" href="/doc/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/doc/assets/chunks/framework.C9InrCCS.js">
    <link rel="modulepreload" href="/doc/assets/chunks/theme.BcV5UMKC.js">
    <link rel="modulepreload" href="/doc/assets/chunks/katex.rPiVaalG.js">
    <link rel="modulepreload" href="/doc/assets/chunks/c4Diagram-b2a90758.CykR4N-c.js">
    <link rel="modulepreload" href="/doc/assets/chunks/flowDiagram-5540d9b9.C08RTu7f.js">
    <link rel="modulepreload" href="/doc/assets/chunks/flowDiagram-v2-3b53844e.BXNkGIxX.js">
    <link rel="modulepreload" href="/doc/assets/chunks/erDiagram-47591fe2.SY7QcDQB.js">
    <link rel="modulepreload" href="/doc/assets/chunks/gitGraphDiagram-96e6b4ee.ZPLQphTb.js">
    <link rel="modulepreload" href="/doc/assets/chunks/ganttDiagram-9a3bba1f.DcqftBEn.js">
    <link rel="modulepreload" href="/doc/assets/chunks/infoDiagram-bcd20f53.yDgoEDVx.js">
    <link rel="modulepreload" href="/doc/assets/chunks/pieDiagram-79897490.Bknok-rS.js">
    <link rel="modulepreload" href="/doc/assets/chunks/quadrantDiagram-62f64e94.B0yz_sI8.js">
    <link rel="modulepreload" href="/doc/assets/chunks/xychartDiagram-ab372869.Bqwhk9ec.js">
    <link rel="modulepreload" href="/doc/assets/chunks/requirementDiagram-05bf5f74.C9WN2seU.js">
    <link rel="modulepreload" href="/doc/assets/chunks/sequenceDiagram-acc0e65c.D0vH57ko.js">
    <link rel="modulepreload" href="/doc/assets/chunks/classDiagram-30eddba6.DEI2Muh2.js">
    <link rel="modulepreload" href="/doc/assets/chunks/classDiagram-v2-f2df5561.B-sBcI4S.js">
    <link rel="modulepreload" href="/doc/assets/chunks/stateDiagram-0ff1cf1a.BNcdFZdX.js">
    <link rel="modulepreload" href="/doc/assets/chunks/stateDiagram-v2-9a9d610d.BRn205aL.js">
    <link rel="modulepreload" href="/doc/assets/chunks/journeyDiagram-4fe6b3dc.B-0DrRwu.js">
    <link rel="modulepreload" href="/doc/assets/chunks/flowchart-elk-definition-5fe447d6.Dl5WamZS.js">
    <link rel="modulepreload" href="/doc/assets/chunks/timeline-definition-fea2a41d.B7y9HJNO.js">
    <link rel="modulepreload" href="/doc/assets/chunks/mindmap-definition-f354de21.DLa5zPPe.js">
    <link rel="modulepreload" href="/doc/assets/chunks/sankeyDiagram-97764748.BSF0Vdpn.js">
    <link rel="modulepreload" href="/doc/assets/chunks/blockDiagram-91b80b7a.Btav0sna.js">
    <link rel="modulepreload" href="/doc/assets/chunks/virtual_mermaid-config.DDnGl6nM.js">
    <link rel="modulepreload" href="/doc/assets/zh_quickstart.md.YC0nSiTK.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-9c7f7752><!--[--><!--]--><!--[--><span tabindex="-1" data-v-2d33b4df></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-2d33b4df> Skip to content </a><!--]--><!----><header class="VPNav" data-v-9c7f7752 data-v-d0a903a0><div class="VPNavBar has-sidebar top" data-v-d0a903a0 data-v-ebf5a18f><div class="wrapper" data-v-ebf5a18f><div class="container" data-v-ebf5a18f><div class="title" data-v-ebf5a18f><div class="VPNavBarTitle has-sidebar" data-v-ebf5a18f data-v-578e83d2><a class="title" href="/doc/zh/" data-v-578e83d2><!--[--><!--]--><!----><span data-v-578e83d2>zeddy</span><!--[--><!--]--></a></div></div><div class="content" data-v-ebf5a18f><div class="content-body" data-v-ebf5a18f><!--[--><!--]--><div class="VPNavBarSearch search" data-v-ebf5a18f><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-ebf5a18f data-v-5fd6f505><span id="main-nav-aria-label" class="visually-hidden" data-v-5fd6f505>Main Navigation</span><!--[--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-ebf5a18f data-v-392d217e data-v-4ba2b2ec><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language" data-v-4ba2b2ec><span class="text" data-v-4ba2b2ec><span class="vpi-languages option-icon" data-v-4ba2b2ec></span><!----><span class="vpi-chevron-down text-icon" data-v-4ba2b2ec></span></span></button><div class="menu" data-v-4ba2b2ec><div class="VPMenu" data-v-4ba2b2ec data-v-457145fc><!----><!--[--><!--[--><div class="items" data-v-392d217e><p class="title" data-v-392d217e>中文</p><!--[--><div class="VPMenuLink" data-v-392d217e data-v-ca935efd><a class="VPLink link" href="/doc/quickstart.html" data-v-ca935efd><!--[-->English<!--]--></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-ebf5a18f data-v-f327893e><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-f327893e data-v-b6484a4d data-v-b2e69d8e><span class="check" data-v-b2e69d8e><span class="icon" data-v-b2e69d8e><!--[--><span class="vpi-sun sun" data-v-b6484a4d></span><span class="vpi-moon moon" data-v-b6484a4d></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-ebf5a18f data-v-8c8ee13a data-v-eae296d0><!--[--><a class="VPSocialLink no-icon" href="https://github.com/zeddy-go/zeddy" aria-label="github" target="_blank" rel="noopener" data-v-eae296d0 data-v-7437008b><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-ebf5a18f data-v-0c7d884a data-v-4ba2b2ec><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-4ba2b2ec><span class="vpi-more-horizontal icon" data-v-4ba2b2ec></span></button><div class="menu" data-v-4ba2b2ec><div class="VPMenu" data-v-4ba2b2ec data-v-457145fc><!----><!--[--><!--[--><div class="group translations" data-v-0c7d884a><p class="trans-title" data-v-0c7d884a>中文</p><!--[--><div class="VPMenuLink" data-v-0c7d884a data-v-ca935efd><a class="VPLink link" href="/doc/quickstart.html" data-v-ca935efd><!--[-->English<!--]--></a></div><!--]--></div><div class="group" data-v-0c7d884a><div class="item appearance" data-v-0c7d884a><p class="label" data-v-0c7d884a>Appearance</p><div class="appearance-action" data-v-0c7d884a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-0c7d884a data-v-b6484a4d data-v-b2e69d8e><span class="check" data-v-b2e69d8e><span class="icon" data-v-b2e69d8e><!--[--><span class="vpi-sun sun" data-v-b6484a4d></span><span class="vpi-moon moon" data-v-b6484a4d></span><!--]--></span></span></button></div></div></div><div class="group" data-v-0c7d884a><div class="item social-links" data-v-0c7d884a><div class="VPSocialLinks social-links-list" data-v-0c7d884a data-v-eae296d0><!--[--><a class="VPSocialLink no-icon" href="https://github.com/zeddy-go/zeddy" aria-label="github" target="_blank" rel="noopener" data-v-eae296d0 data-v-7437008b><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-ebf5a18f data-v-0d79d714><span class="container" data-v-0d79d714><span class="top" data-v-0d79d714></span><span class="middle" data-v-0d79d714></span><span class="bottom" data-v-0d79d714></span></span></button></div></div></div></div><div class="divider" data-v-ebf5a18f><div class="divider-line" data-v-ebf5a18f></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-9c7f7752 data-v-c186d97c><div class="container" data-v-c186d97c><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-c186d97c><span class="vpi-align-left menu-icon" data-v-c186d97c></span><span class="menu-text" data-v-c186d97c>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-c186d97c data-v-a6768510><button data-v-a6768510>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-9c7f7752 data-v-287624f6><div class="curtain" data-v-287624f6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-287624f6><span class="visually-hidden" id="sidebar-aria-label" data-v-287624f6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-287624f6><section class="VPSidebarItem level-0 has-active" data-v-287624f6 data-v-280cc9f4><!----><div class="items" data-v-280cc9f4><!--[--><div class="VPSidebarItem level-1 is-link" data-v-280cc9f4 data-v-280cc9f4><div class="item" data-v-280cc9f4><div class="indicator" data-v-280cc9f4></div><a class="VPLink link link" href="/doc/zh/quickstart.html" data-v-280cc9f4><!--[--><p class="text" data-v-280cc9f4>快速开始</p><!--]--></a><!----></div><!----></div><section class="VPSidebarItem level-1" data-v-280cc9f4 data-v-280cc9f4><div class="item" role="button" tabindex="0" data-v-280cc9f4><div class="indicator" data-v-280cc9f4></div><h3 class="text" data-v-280cc9f4>概念</h3><!----></div><div class="items" data-v-280cc9f4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-280cc9f4 data-v-280cc9f4><div class="item" data-v-280cc9f4><div class="indicator" data-v-280cc9f4></div><a class="VPLink link link" href="/doc/zh/concept/ioc.html" data-v-280cc9f4><!--[--><p class="text" data-v-280cc9f4>IoC</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-280cc9f4 data-v-280cc9f4><div class="item" data-v-280cc9f4><div class="indicator" data-v-280cc9f4></div><a class="VPLink link link" href="/doc/zh/concept/module.html" data-v-280cc9f4><!--[--><p class="text" data-v-280cc9f4>模块</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1" data-v-280cc9f4 data-v-280cc9f4><div class="item" role="button" tabindex="0" data-v-280cc9f4><div class="indicator" data-v-280cc9f4></div><h3 class="text" data-v-280cc9f4>模块列表</h3><!----></div><div class="items" data-v-280cc9f4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-280cc9f4 data-v-280cc9f4><div class="item" data-v-280cc9f4><div class="indicator" data-v-280cc9f4></div><a class="VPLink link link" href="/doc/zh/module/configx.html" data-v-280cc9f4><!--[--><p class="text" data-v-280cc9f4>configx</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-280cc9f4 data-v-280cc9f4><div class="item" data-v-280cc9f4><div class="indicator" data-v-280cc9f4></div><a class="VPLink link link" href="/doc/zh/module/ginx.html" data-v-280cc9f4><!--[--><p class="text" data-v-280cc9f4>ginx</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-9c7f7752 data-v-b9757b05><div class="VPDoc has-sidebar has-aside" data-v-b9757b05 data-v-7a01fee6><!--[--><!--]--><div class="container" data-v-7a01fee6><div class="aside" data-v-7a01fee6><div class="aside-curtain" data-v-7a01fee6></div><div class="aside-container" data-v-7a01fee6><div class="aside-content" data-v-7a01fee6><div class="VPDocAside" data-v-7a01fee6 data-v-6e0967a7><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-6e0967a7 data-v-11795add><div class="content" data-v-11795add><div class="outline-marker" data-v-11795add></div><div class="outline-title" role="heading" aria-level="2" data-v-11795add>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-11795add><span class="visually-hidden" id="doc-outline-aria-label" data-v-11795add> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-11795add data-v-e4d379d6><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-6e0967a7></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7a01fee6><div class="content-container" data-v-7a01fee6><!--[--><!--]--><main class="main" data-v-7a01fee6><div style="position:relative;" class="vp-doc _doc_zh_quickstart" data-v-7a01fee6><div><h1 id="快速开始" tabindex="-1">快速开始 <a class="header-anchor" href="#快速开始" aria-label="Permalink to &quot;快速开始&quot;">​</a></h1><p>这里为您提供了一些项目例子，供您快速开始。理论上，只要保证 app 包能正常运行您定义的 <code>模块</code> ，那么任何目录结构都是可行的。</p><h2 id="http服务" tabindex="-1">http服务 <a class="header-anchor" href="#http服务" aria-label="Permalink to &quot;http服务&quot;">​</a></h2><p>克隆代码到本地</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> step1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --single-branch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> git@github.com:zeddy-go/quickstart.git</span></span></code></pre></div><p>我们可以看到如下目录结构</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>.</span></span>
<span class="line"><span>├── conf                       //配置</span></span>
<span class="line"><span>│   ├── config.go</span></span>
<span class="line"><span>│   └── config.yaml</span></span>
<span class="line"><span>├── go.mod</span></span>
<span class="line"><span>├── go.sum</span></span>
<span class="line"><span>├── main.go                     //入口文件</span></span>
<span class="line"><span>└── module                      //模块</span></span>
<span class="line"><span>    └── user                    //用户模块</span></span>
<span class="line"><span>        ├── iface               //接口层</span></span>
<span class="line"><span>        │     └── http          //http接口</span></span>
<span class="line"><span>        │         └── user.go   //user handler</span></span>
<span class="line"><span>        └── module.go           //模块入口</span></span></code></pre></div><p>我们使用embed的方式来加载配置，然后通过环境变量来对配置做改动。 这种方式在容器化部署的场景下非常方便。</p><p>我们引用了 ginx 模块和 user 模块。 ginx 模块为框架内置模块，用于处理 http 请求，底层使用 gin 。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>您完全可以使用任何您喜欢的http库编写自己的http处理模块。或者自己造轮子💯。</p></div><p>user 模块则是我们自己的业务模块。 user 模块实现了一个 handler 方法，当接收到请求时，该方法会输出 hello xxxx! 的JSON响应(module/user/iface/http/user.go)。 接着，它向 ginx 模块注册了一个路由，以接收对应的请求(module/user/module.go:30)。</p><p>在这里您会注意到 container.Invoke 方法。没错，框架使用了<code>依赖注入</code>。 (我们正尝试在开发效率和执行效率之间找到平衡。) 而对象的实例化方法则是在上面的Init方法中进行绑定(module/user/module.go:21)。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>请在Init方法中绑定实例化方法，在Boot方法中或其他地方使用他们。</p></div><p>启动服务 <code>go run .</code> ，然后访问 <a href="http://localhost:8080/hello?username=zed" target="_blank" rel="noreferrer">http://localhost:8080/hello?username=zed</a> 。</p><h2 id="更完整的例子" tabindex="-1">更完整的例子 <a class="header-anchor" href="#更完整的例子" aria-label="Permalink to &quot;更完整的例子&quot;">​</a></h2><p>克隆代码到本地</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> step2</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --single-branch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> git@github.com:zeddy-go/quickstart.git</span></span></code></pre></div><p>在这个例子中，目录结构如下:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>.</span></span>
<span class="line"><span>├── config                                //配置</span></span>
<span class="line"><span>│   ├── config.go</span></span>
<span class="line"><span>│   └── config.yaml</span></span>
<span class="line"><span>├── docker-compose.yaml                   //这个例子使用docker来启动MySQL数据库</span></span>
<span class="line"><span>├── go.mod</span></span>
<span class="line"><span>├── go.sum</span></span>
<span class="line"><span>├── main.go                               //入口文件</span></span>
<span class="line"><span>└── module</span></span>
<span class="line"><span>    └── user</span></span>
<span class="line"><span>        ├── domain                        //领域层</span></span>
<span class="line"><span>        │         ├── contract.go         //一些接口</span></span>
<span class="line"><span>        │         ├── svc                 //服务</span></span>
<span class="line"><span>        │         │     └── user.go</span></span>
<span class="line"><span>        │         └── user.go             //领域实体</span></span>
<span class="line"><span>        ├── iface                         //接口层</span></span>
<span class="line"><span>        │         └── http</span></span>
<span class="line"><span>        │               ├── payload.go</span></span>
<span class="line"><span>        │               └── user.go       //用户 handler</span></span>
<span class="line"><span>        ├── infra</span></span>
<span class="line"><span>        │         ├── migration           //迁移</span></span>
<span class="line"><span>        │         │     ├── 20240408063653_create_users_table.down.sql</span></span>
<span class="line"><span>        │         │     ├── 20240408063653_create_users_table.up.sql</span></span>
<span class="line"><span>        │         │     └── migration.go</span></span>
<span class="line"><span>        │         ├── model               //数据模型</span></span>
<span class="line"><span>        │         │     └── user.go</span></span>
<span class="line"><span>        │         ├── repo                //仓库</span></span>
<span class="line"><span>        │         │     └── user.go</span></span>
<span class="line"><span>        │         └── seed                //数据填充</span></span>
<span class="line"><span>        │               └── user.go</span></span>
<span class="line"><span>        └── module.go                     //模块入口</span></span></code></pre></div><h3 id="数据操作相关" tabindex="-1">数据操作相关 <a class="header-anchor" href="#数据操作相关" aria-label="Permalink to &quot;数据操作相关&quot;">​</a></h3><p>在这个例子中数据模型与领域实体相似，但在实际项目中，一个领域实体也可能由多个数据模型的数据组成。 业务逻辑只使用领域实体，所以在通过仓库对数据做操作时，仓库会帮我们进行双向转换。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>仓库内置了简单的转换逻辑，但无法满足复杂情况。这时就需要自定义转换逻辑。</p></div><h3 id="数据迁移" tabindex="-1">数据迁移 <a class="header-anchor" href="#数据迁移" aria-label="Permalink to &quot;数据迁移&quot;">​</a></h3><p>框架内置的 migration 模块使用 github.com/golang-migrate/migrate 包实现迁移。 这同样需要在模块入口中注册(module/user/module.go:41)。程序启动后，数据表会自动创建到数据库。</p><h3 id="数据填充" tabindex="-1">数据填充 <a class="header-anchor" href="#数据填充" aria-label="Permalink to &quot;数据填充&quot;">​</a></h3><p>框架内置了数据填充，原理很简单，就是利用容器执行函数。 这同样需要在模块入口中注册(module/user/module.go:42)。 程序启动后，数据会自动填充到数据库。</p><h3 id="user-handler" tabindex="-1">user handler <a class="header-anchor" href="#user-handler" aria-label="Permalink to &quot;user handler&quot;">​</a></h3><p>在 user handler 中，我们添加了两个方法，一个是创建用户的方法，一个是获取用户信息的方法。 与第一个例子一样，我们在 module.go 中也新注册了两个路由。</p><p>您会发现这两个新方法与第一个例子中的方法的返回值数量不一样。 这正是框架的另一个特性，handler函数的可变参数和返回值。 框架允许您为每个handler函数设计自己的参数和返回值。 对于参数，框架会遍历参数列表，查找容器中的对象(依赖注入)或者解析请求的参数。 对于返回值，框架会遍历返回值列表，来决定如何返回响应。</p><h2 id="添加grpc服务" tabindex="-1">添加grpc服务 <a class="header-anchor" href="#添加grpc服务" aria-label="Permalink to &quot;添加grpc服务&quot;">​</a></h2><p>克隆代码到本地</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> step3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --single-branch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> git@github.com:zeddy-go/quickstart.git</span></span></code></pre></div><p>我们在上面的项目的基础上添加grpc服务，这样我们的服务不仅能服务http也能同时服务grpc，还能展示代码重用的特性。 当然，如果您的项目只需要基于grpc，您完全可以不用理会http相关的代码。</p><p>项目目录结构如下:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>.</span></span>
<span class="line"><span>├── conf</span></span>
<span class="line"><span>│    ├── config.go</span></span>
<span class="line"><span>│    └── config.yaml</span></span>
<span class="line"><span>├── docker-compose.yaml</span></span>
<span class="line"><span>├── go.mod</span></span>
<span class="line"><span>├── go.sum</span></span>
<span class="line"><span>├── main.go</span></span>
<span class="line"><span>├── module</span></span>
<span class="line"><span>│       └── user</span></span>
<span class="line"><span>│             ├── domain</span></span>
<span class="line"><span>│             │       ├── contract.go</span></span>
<span class="line"><span>│             │       ├── svc</span></span>
<span class="line"><span>│             │       │     └── user.go</span></span>
<span class="line"><span>│             │       └── user.go</span></span>
<span class="line"><span>│             ├── iface</span></span>
<span class="line"><span>│             │       ├── grpc</span></span>
<span class="line"><span>│             │       │     └── user.go            //grpc接口实现</span></span>
<span class="line"><span>│             │       └── http</span></span>
<span class="line"><span>│             │           ├── payload.go</span></span>
<span class="line"><span>│             │           └── user.go</span></span>
<span class="line"><span>│             ├── infra</span></span>
<span class="line"><span>│             │       ├── migration</span></span>
<span class="line"><span>│             │       │     ├── 20240408063653_create_users_table.down.sql</span></span>
<span class="line"><span>│             │       │     ├── 20240408063653_create_users_table.up.sql</span></span>
<span class="line"><span>│             │       │     └── migration.go</span></span>
<span class="line"><span>│             │       ├── model</span></span>
<span class="line"><span>│             │       │     └── user.go</span></span>
<span class="line"><span>│             │       ├── repo</span></span>
<span class="line"><span>│             │       │     └── user.go</span></span>
<span class="line"><span>│             │       └── seed</span></span>
<span class="line"><span>│             │             └── user.go</span></span>
<span class="line"><span>│             └── module.go</span></span>
<span class="line"><span>├── pb                                             //pb文件</span></span>
<span class="line"><span>│    ├── user_grpc.pb.go</span></span>
<span class="line"><span>│    └── user.pb.go</span></span>
<span class="line"><span>├── readme.md</span></span>
<span class="line"><span>└── user.proto                                     //proto文件</span></span></code></pre></div><p>在 main.go 文件中，我们添加内置的 grpc 模块(main.go:21)。 而注册我们自己的服务，只需在 module/user/module.go 文件中从容器中拿到已实例化好的 *grpc.Server 即可(module/user/module.go:44,module/user/module.go:65)。另外，您可以看到，在grpc接口实现文件里面，我们重用了 <code>userService</code> 。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>您完全可以将您的常用代码以<code>模块</code>的形式固化起来。</p></div><p>容器中的每个对象默认为单例模式，得益于常驻内存，已实例化的对象将不再重复实例化，这对执行效率来说是一件好事。</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>github.com/zeddy-go/zeddy/errx 包默默的收集了错误栈，您可以使用这样的代码来打印它 fmt.Printf(&quot;%#v&quot;, err) 。 并且，这些信息在经过grpc传输后也不会丢失。</p></div></div></div></main><footer class="VPDocFooter" data-v-7a01fee6 data-v-9a032d81><!--[--><!--]--><!----><nav class="prev-next" data-v-9a032d81><div class="pager" data-v-9a032d81><!----></div><div class="pager" data-v-9a032d81><a class="VPLink link pager-link next" href="/doc/zh/concept/ioc.html" data-v-9a032d81><!--[--><span class="desc" data-v-9a032d81>Next page</span><span class="title" data-v-9a032d81>IoC</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"D5XJPeEI\",\"zh_concept_module.md\":\"BN80lJV5\",\"module_configx.md\":\"C87jjTPA\",\"markdown-examples.md\":\"BBFyeFKt\",\"quickstart.md\":\"Bpt8CVfy\",\"zh_index.md\":\"CLWadiwW\",\"zh_concept_ioc.md\":\"ktV6d4ar\",\"concept_module.md\":\"IQueO1ym\",\"zh_module_configx.md\":\"C6-Q-6UX\",\"concept_ioc.md\":\"CpXG-047\",\"zh_module_ginx.md\":\"Bm9FohXi\",\"api-examples.md\":\"BGcoxGv1\",\"module_ginx.md\":\"B5fiqbhn\",\"zh_quickstart.md\":\"YC0nSiTK\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"zeddy\",\"description\":\"A Convenient Framework\",\"base\":\"/doc/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[],\"sidebar\":{\"/\":[{\"text\":\"\",\"items\":[{\"text\":\"quick start\",\"link\":\"/quickstart\"},{\"text\":\"concept\",\"items\":[{\"text\":\"IoC\",\"link\":\"/concept/ioc.md\"},{\"text\":\"module\",\"link\":\"/concept/module.md\"}]},{\"text\":\"module list\",\"items\":[{\"text\":\"configx\",\"link\":\"/module/configx\"},{\"text\":\"ginx\",\"link\":\"/module/ginx\"}]}]}],\"/zh/\":[{\"text\":\"\",\"items\":[{\"text\":\"快速开始\",\"link\":\"/zh/quickstart\"},{\"text\":\"概念\",\"items\":[{\"text\":\"IoC\",\"link\":\"/zh/concept/ioc.md\"},{\"text\":\"模块\",\"link\":\"/zh/concept/module.md\"}]},{\"text\":\"模块列表\",\"items\":[{\"text\":\"configx\",\"link\":\"/zh/module/configx\"},{\"text\":\"ginx\",\"link\":\"/zh/module/ginx\"}]}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/zeddy-go/zeddy\"}]},\"locales\":{\"root\":{\"label\":\"English\",\"lang\":\"en\"},\"zh\":{\"label\":\"中文\",\"lang\":\"zh\"}},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>